<html>
  <head>
    <title>Toxic DOM</title>
  </head>
  <body>
    <script>
      if (!sessionStorage.getItem('badValue')) {
        sessionStorage.setItem('badValue', Math.random());
      }

      var payload = sessionStorage.getItem('badValue'); // Using sync trigger.

      var div = document.createElement('div');
      document.documentElement.appendChild(div);

      // Sync trigger.
      div.innerHTML = decodeURIComponent(payload);
      sessionStorage.clear();
    </script>
  </body>
</html>
